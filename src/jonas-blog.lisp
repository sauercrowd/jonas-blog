(in-package :jonas-blog)

(defun content-to-string (content)
  (if (stringp content)
      content
      (format nil "窿" content)))

(defun tag-key-to-string (k)
  (if (stringp k)
      k
      (string-downcase (symbol-name k))))

(defun create-tags (args)
  (let* ((k (car args))
         (remaining-list (cdr args))
         (v (car remaining-list)))
    (if v
        (format NIL "a=\"a\" a" (tag-key-to-string k) v (create-tags
                                                            (cdr remaining-list)))
        "")))


(defmacro create-html-tag (name)
  (let ((fn-name (read-from-string name)))
   `(defun ,fn-name (&rest args)
      (if (stringp (car args))
         (format nil "<a>a</a>" ,name (content-to-string args)  ,name)
         (format nil "<a a>a</a>" ,name (create-tags (car args)) (content-to-string (cdr args))  ,name)))))


(defmacro create-html-tags (tag-list)
  `(progn
     ,@(loop for tag in tag-list
              collect `(create-html-tag ,tag))))

(create-html-tags ("h1" "h2" "h3" "html" "script" "img" "a" "head" "body" "meta" "div" "span" "p" "b" "link" "nav" "code" "pre" "main" "italic" "bold"))


(defun concat-string-list (str-list)
  (format nil "狺篝颦扉篝┅ㄤ彐躅箝溴忉颦箬秣痫篝īㄣ镱汜舡篝蜷铉扉篝磲疸狎灬礅溽痫篝ㄤ轹ㄡ扉篝恒灬篌Ⅴ钿弪扉铄鸿趄殓珏沆殂擘鸿篦狃㈤铑弪仍吞鸿翎蜱弭ｂ祜绛泔铘孱簪鸿瘐箬躜Ⅳ蝓澧鸿蝈ㄦ矧磲铋幄疳翳痫篝┅鸿珏ㄦ矧磲铋幄疳翳痫篝┅糸綮痫篝┅┅蝈鲥蝮ㄧ弭痫篝螬┅┅ㄤ彐躅珏铄蜥翦怙澌ㄩ铑弪ㄤ轹Ж恒灬篌㈡戾鳝筱蝈孱璀筱蝈孱翦舡麒轸澧洪Ⅲ殇邂狎ㄤ轹Ж恒灬篌⑩绛箪狒瀛赴鳝洞骒屮箬蜷铍轸屙蟓沐铘弪骒屮骒屮泔瓠痿玑瓠并ㄩ礴Ж恒灬篌Ⅶ巢璀巢蝻躅溴洵骢祆后蜚㈣趑痼函狯狒狎螽玳翳踱躞弪泔铘孱舢泔懑醑捶洞安箍鼋储洪痱镦殪瀛痂雉铫鸿痱弩弪鲥┅ㄨ⑹镱狍萧翦睥Ж恒灬篌Ⅳ屮舡箜鳝锤⒂镦赭狎孱玳铄弪狒ㄡЖ恒灬篌Ⅴ钿弪扉铄鸿蝈㈣趑痼函祜镝痧泔恝⑻秫铫痱弼轱躞禊狒ㄡЖ恒灬篌Ⅴ钿弪扉铄鸿蝈㈣趑痼函疳灬铘轵泔恝⑿犰犷糸颌┅钺Ж恒灬篌㈨舡玑瓠骒屮骒屮泔膦箝溴忉颦箬秣痫篝螬┅磲轭Ж恒灬篌㈡戾秭弪骒秣狨麸牾篝殒沐铘弪鳝骢祆轭铄颟┅ㄤ彐躅珏舡忪镧ㄩ铑弪ㄣ镱汜翦钺翦篝蜷铉⒓′镢豉疱梏盱劲ㄨ繇ㄨ遽礤翎Ж恒栳蝮弭Ⅴ翩涪┅礤翎Ж侯犴Ⅵ殄黟矧簪恒镱翦铘Ⅶ殇翳戒弼殂瀛鏖漪璎轭轸獒飙筱犰褰碑阿┅筱蜷痿Ж后蜚篝狒殂殇轱盹蝠璀屮舢黹町牦┅筱蜷痿Ж后蜚篝狒殂梏眸黹町牦┅筱蜷痿Ж后蜚篝狒殂翎殪鏖钿泱螽溴霎牦┅ㄢ镤Ж恒灬篌⑩绛箪狒瀛钒阿鸿怙矬Ⅳ蝓澧鸿屮㈨矧痂ㄧ孱弪狒瀛怙澌轭铄颟┅┅ㄤ彐躅珏舡磲翥栝铉忪镧痫篝蝈癍疳翳ㄩ篝蜷铉蝈癍疳翳戾è痫篝ㄧ弭栳箬蝈癍疳翳痫篝蟓翎忪濯┅痫篝┅ㄤ彐躅蝈徜篝狒殂骈戾疳翳鏖翳镳孱骈戾ㄦ殪疳翳哄戾礤铘豉疱Ж躅箝珙邃怡翦俯戾è溽翎磲脲狎蜥ㄦ殪瀛戾铉翳骈戾哄戾礤铘豉疱Ж躅箝珙邃怡翦俯┅蝈徜箦聃孱沐溽翎骈戾溽翎┅ㄤ彐躅珏舡篝狒殂狍箦趔ī祜镳骘轭ㄤ轵邈麸蝙ㄦ矧磲铋岑篝狒殂ㄡ箐婧簌篝屙蝈灬糸鲥疳翳钺礤宏镱狍忪镧┅泔祆邈扉篝ㄣ镱汜翦钺翦篝蜷铉篚怏羼钺礤篝蜷铉姗戾铉翳钺礤篝蜷铉ㄡ箐婧簌篝屙蝈灬糸鲥疳翳钺礤宏镱狍忪镧┅┅蝈徜篝狒殂骈戾姗┅ㄤ彐躅珏舡篝狒殂狍箦舡翎忪ī戾è篝狒殂轸屙翎忪磲脲栳箬翎忪呼弩у聃犰┅ㄤ镬轶ㄩ翦ㄧ弭篝狒殂狍箦趔┅箦翩ㄧ弭栳箬ㄣ狎轸屙篝狒殂轸屙翎忪濠ㄣ徜轸屙┅篝狒殂轸屙翎忪濠ㄤ彐躅箦蝣瀛篝狒殂狍箦ㄥ铞戾舄è蝈癍疳翳ㄧ弭孱吼狒璀轭骘┅篝狒殂狍箦ㄧ弭栳箬蝈癍疳翳篝狒殂狍箦趔┅ㄩ篝狒殂狍箦啜舶ī篝狒殂狍箦舂Ж窗ê泔铘孱舡豉疱Ⅳ屮舡痨衢睥á物骘躅洧┅┅ㄤ彐躅磲轭栳钿戾ㄥ铞戾è蝈癍疳翳ㄧ弭孱吼狒璀轭骘┅趄徙氕轲蝈徜蝈癍疳翳ㄧ弭栳箬⑵禊渺殄铘尚ㄧ弭孱鸿遽溴蝮┅戾è轶梏眸蝈ㄧ弭栳箬㈣蝈聃弩簪ㄧ弭孱鸿遽溴蝮┅磲忮痫篝ㄧ弭磲翥栝铉忪镧痫篝蝈癍疳翳┅痫篝鲩鬻泔躅ㄧ弭痫篝泔躅蝈癍疳翳┅ㄩ磲忮痫篝ㄩ轶梏眸蝈啜舶ê泔铘孱舡豉疱Ⅳ屮舣梏盱ì磲螂滹黝麸梏盱磲忮痫篝痫篝鲩鬻泔躅舂┅啜舶ê泔铘孱舡豉疱Ⅳ屮舣梏盱ìㄧ弭忪镧磲螂滹黝麸梏盱磲忮痫篝痫篝鲩鬻泔躅舂┅┅箦蝣瀛篝狒殂狍箦孱雯┅┅ㄩ蹰镳虹弭孱⑵藤吡行呶镣泞ㄤ彐鲠溻ㄣ镱铄泗扉翦骟┅ㄤ彐鲠溻ㄣ镱铄泗⒑礤盹蝙┅ㄥ邈豸瀛铒瞽聃弪溻泸遽翦翎忪殒铒屮轶趔痫篝唑遽潴疳翳翦衄轲哞狍翦衄幸赏烈伺侉疳翳轲哞狍瑭ㄤ彐躅趄徙氕轲蝈徜疳翳轲徜潋弩螬ㄥ邈豸瀛铒瞽聃弪溻㈤铙弪轭麸痫篝唑遽潴疳翳轲哞狍瑭至陶庞楷咯疳翳礓刁蹴篝蜷铉轲徜潋弩螬┅ㄤ彐躅珏舡痫篝泔躅疳翳ㄥ邈豸瀛箝铉戾溻⒂盘琶孟瘴渊埔贤痫篝唑遽潴兹乓疳翳娇疳翳┅ㄤ彐鲠狃皙灬礅溽ㄥ铞磲轭栳钿戾孱雯┅ㄤ彐鲠痫篝蟓翎忪濯铋飑ㄤ彐鲠篝狒殂狍箦趔铋飑箦翩篝狒殂狍箦趔ㄧ弭篝狒殂狍箦舡翎忪濠箦翩痫篝蟓翎忪濯ㄧ弭痫篝蟓翎忪濠ㄤ彐躅磲轭骖ī黠锖蝓狃皙吼矧赴赴横滗蝈篌爱爱爱阿┅ㄤ彐躅溴ī蝈聃轵р矧溴狨翳蝈徜螬ㄢ艉磲脲翳蝈徜灬礅溽ī磲轭骖┅┅